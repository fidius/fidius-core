#!/usr/bin/ruby

require 'yaml'
require 'drb'

begin
  cfg = YAML.load_file(File.expand_path '../../config/msf.yml', __FILE__)
rescue
  puts "No DRb config `config/msf.yml' found."
  raise
end

$:.unshift(File.join cfg[:msf_path], 'lib')
require 'msf/base'

uri = "druby://#{cfg[:drb_host]}:#{cfg[:drb_port]}"
puts uri
puts 'Loading Metasploit framework'
framework = Msf::Simple::Framework.create
DRb.start_service uri, framework
puts 'Loaded. Waiting...'
DRb.thread.join


