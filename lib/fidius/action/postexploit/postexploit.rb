module FIDIUS
  module Action
    module PostExploit

      autoload :GetInterfaces,     'fidius/action/postexploit/getinterfaces'

      module PostExploit
        include FIDIUS::Action

        # Runs the post exploit on the given meterpreter session.
        #
        # @return [boolean]
        def run session
        end

        # Returns true if this post exploit need root or admin rights to run.
        #
        # @return [boolean]
        def needs_root
          false
        end

      end #class PostExploit

      def self.run sessionID, name
        postexpl = nil
        if name == "getInterfaces"
          postexpl = FIDIUS::Action::PostExploit::GetInterfaces.new
        end
        raise RuntimeError, "wrong post exploit name" unless postexpl
        session = FIDIUS::Action::Msf.instance.framework.sessions[sessionID]
        postexpl.run session
      end
    end #module PostExploit
  end #module Action
end #module FIDIUS
