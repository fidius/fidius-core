require 'test_fidius'
require 'active_support/testing/assertions'

class ExploitTest < FIDIUS::Test
 include ActiveSupport::Testing::Assertions
  def test_pwn_host
    autopwner = FIDIUS::Action::Exploit::Exploit.instance
    h = FIDIUS::Asset::Host.find_or_create_by_ip "192.168.56.101"
    inter = h.find_or_create_by_ip "192.168.56.101"
    scan = FIDIUS::Action::Scan::PortScan.new(inter)
    target = scan.execute
    assert_difference('FIDIUS::Session.all.count',+1) do
      result = autopwner.autopwn inter  
    end
  end
end
